"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[861],{40923:function(V,O,e){e.r(O);var I=e(27424),E=e.n(I),b=e(17061),u=e.n(b),L=e(17156),m=e.n(L),R=e(2618),U=e(90930),f=e(92276),A=e(37476),j=e(90672),g=e(5966),y=e(9927),B=e(67757),P=e(2453),K=e(14726),l=e(67294),W=e(10581),a=e(85893),H=B.Z.Dragger,J={name:"file",multiple:!1,action:"/api/system/upgrade",accept:".zip",headers:{authorization:"Bearer "+localStorage.getItem("token")},onChange:function(){var D=m()(u()().mark(function C(r){var o;return u()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:o=r.file.status,o!=="uploading"&&console.log(r.file,r.fileList),o==="done"?r.file.response.success?P.ZP.success("\u4E0A\u4F20\u6210\u529F"):P.ZP.error(r.file.response.msg):o==="error"&&P.ZP.error("".concat(r.file.name," file upload failed."));case 3:case"end":return d.stop()}},C)}));function i(C){return D.apply(this,arguments)}return i}(),onDrop:function(i){console.log("Dropped files",i.dataTransfer.files)}},S=function(){(0,l.useEffect)(function(){},[]);var i=(0,l.useRef)(),C=(0,l.useState)(!1),r=E()(C,2),o=r[0],v=r[1],d=(0,l.useState)(),M=E()(d,2),z=M[0],Z=M[1],w=(0,l.useState)(null),T=E()(w,2),F=T[0],Y=T[1],$=(0,l.useState)(null),x=E()($,2),G=x[0],N=x[1];function Q(t){return h.apply(this,arguments)}function h(){return h=m()(u()().mark(function t(n){var _;return u()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return _=new FormData,console.log(n),_.append("sn",n.sn),_.append("licensePub",F),_.append("licenseKey",G),c.abrupt("return",(0,y.request)("/api/license/update",{method:"PUT",data:_,headers:{ContentType:"multipart/form-data"}}));case 6:case"end":return c.stop()}},t)})),h.apply(this,arguments)}return(0,a.jsxs)(U._z,{children:[(0,a.jsxs)(f.vY,{actionRef:i,title:"\u6388\u6743\u4FE1\u606F",column:1,request:m()(u()().mark(function t(){var n;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,R.YQ)();case 2:return n=s.sent,Z(n.data),s.abrupt("return",n);case 5:case"end":return s.stop()}},t)})),extra:(0,a.jsx)(K.ZP,{type:"link",onClick:function(){v(!0)},children:"\u6388\u6743"}),children:[(0,a.jsx)(f.vY.Item,{dataIndex:"status",label:"\u6388\u6743\u72B6\u6001",valueEnum:{false:{text:"\u672A\u6388\u6743",status:"Error"},true:{text:"\u5DF2\u6388\u6743",status:"Success"}}}),(0,a.jsx)(f.vY.Item,{label:"\u6700\u5927\u6CE8\u518C\u5206\u673A",dataIndex:"maxExtensionNum",valueType:"text"}),(0,a.jsx)(f.vY.Item,{label:"\u6700\u5927\u5E76\u53D1\u547C\u53EB\u6570",dataIndex:"maxConcurrentCall",valueType:"text"})]}),(0,a.jsxs)(A.Y,{title:"\u7CFB\u7EDF\u6388\u6743",width:"800px",open:o,onOpenChange:v,modalProps:{destroyOnClose:!0,onCancel:function(){}},initialValues:z,onFinish:function(){var t=m()(u()().mark(function n(_){var s;return u()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Q(_);case 2:s=p.sent,s.success?(v(!1),localStorage.removeItem("token"),W.m.push("/user/login")):P.ZP.error(s==null?void 0:s.msg);case 4:case"end":return p.stop()}},n)}));return function(n){return t.apply(this,arguments)}}(),children:[(0,a.jsx)(j.Z,{label:"\u673A\u5668\u7801",readonly:!0,disabled:!0,rules:[{required:!0}],width:"xl",name:"sn"}),(0,a.jsx)(g.Z,{label:"\u6388\u6743\u6587\u4EF6\u516C\u94A5",fieldProps:{type:"file",onChange:function(n){Y(n.target.files[0])}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u673A\u53F7"}],width:"xl",name:"licensePub"}),(0,a.jsx)(g.Z,{label:"\u6388\u6743\u6587\u4EF6\u5BC6\u94A5",fieldProps:{type:"file",onChange:function(n){N(n.target.files[0])}},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u673A\u53F7"}],width:"xl",name:"licenseKey"})]})]})};O.default=S}}]);
